{
  "metadata": {
    "title": "Send HTML Emails with Images in PHP",
    "slug": "send-html-email-php",
    "uniqueId": "df157f8c",
    "category": "programming-languages",
    "subcategory": "php",
    "description": "Learn how to send HTML-formatted emails, including images, using PHP's mail() function and external libraries like PHPMailer.",
    "tags": [
      "php",
      "html",
      "email",
      "mail",
      "PHPMailer",
      "MIME"
    ],
    "difficulty": "intermediate",
    "readTime": 8,
    "lastUpdated": "2024-09-21T12:30:00.000Z",
    "sourceStackOverflowId": "11238953",
    "votes": 93
  },
  "content": "# Send HTML Emails with Images in PHP\n\nSending HTML-formatted emails with embedded or linked images in PHP is a common requirement for applications like newsletters, notifications, and password resets. This guide will walk you through the process using the native `mail()` function and introduce more robust solutions like PHPMailer.\n\n## Quick Answer\n\nTo send an HTML email using PHP's `mail()` function, you must set the `Content-Type` header to `text/html`. For images, link them using absolute URLs to an externally hosted server.\n\n```php\n<?php\n$to = 'recipient@example.com';\n$subject = 'HTML Email with Image';\n$message = '\n<html>\n<head>\n  <title>My HTML Email</title>\n</head>\n<body>\n  <h1>Hello from PHP!</h1>\n  <p>This is an HTML email with an image:</p>\n  <img src=\"http://yourdomain.com/images/logo.png\" alt=\"Company Logo\">\n  <p>Best regards,</p>\n  <p>Your Team</p>\n</body>\n</html>';\n\n$headers = \"MIME-Version: 1.0\\r\\n\";\n$headers .= \"Content-type:text/html;charset=UTF-8\\r\\n\";\n$headers .= 'From: Your Name <your_email@example.com>' . \"\\r\\n\";\n\nif (mail($to, $subject, $message, $headers)) {\n    echo \"HTML email sent successfully!\";\n} else {\n    echo \"Failed to send HTML email.\";\n}\n?>\n```\n\n## Choose Your Method\n\nDeciding how to send HTML emails in PHP depends on your project's complexity, reliability needs, and whether you need to attach files directly.\n\n```mermaid\ngraph TD\n    A[Start] --> B{Need to send HTML email?};\n    B -- Yes --> C{Need to embed images or attach files directly?};\n    C -- No, link images externally --> D[Use PHP's native mail() function];\n    D --> E[Set Content-Type: text/html header];\n    D --> F[Use absolute URLs for images];\n    F --> G[End];\n    C -- Yes, embed/attach --> H{Consider external library};\n    H -- Yes, for robustness/features --> I[Use PHPMailer or Symfony Mailer];\n    I --> J[Configure SMTP, add attachments/embedded images];\n    J --> G;\n    H -- No, simple embedding --> K[Advanced mail() with CID for embedded images];\n    K --> L[Requires complex MIME headers];\n    L --> G;\n```\n![Email Sending Decision Tree](/images/df157f8c-1.webp)\n\n## Ready-to-Use Code\n\nHere are a few common scenarios for sending HTML emails.\n\n### 1. Basic HTML Email with External Images\n\nThis is the most straightforward approach using PHP's built-in `mail()` function. Images are linked from a web server.\n\n```php\n<?php\n$to = 'bob@example.com';\n$subject = 'Website Change Request';\n\n// Set headers for HTML email\n$headers  = \"From: Your Website <no-reply@yourdomain.com>\\r\\n\";\n$headers .= \"Reply-To: support@yourdomain.com\\r\\n\";\n$headers .= \"MIME-Version: 1.0\\r\\n\";\n$headers .= \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n\n// HTML message content\n$message = '\n<html>\n<head>\n  <title>Change Request</title>\n</head>\n<body>\n  <p><strong>This is strong text</strong> while this is not.</p>\n  <p>Here is an image from your server:</p>\n  <img src=\"http://yourdomain.com/images/header_logo.png\" alt=\"Logo\" style=\"width:150px;\">\n  <p>Thank you for your request.</p>\n</body>\n</html>';\n\n// Send the email\nif (mail($to, $subject, $message, $headers)) {\n    echo \"Email sent successfully!\";\n} else {\n    echo \"Email sending failed.\";\n}\n?>\n```\n\n### 2. HTML Email with Dynamic Content\n\nThis example demonstrates how to inject dynamic data into your HTML email message.\n\n```php\n<?php\nfunction sendForgotPasswordEmail($pass, $name, $to) {\n    $body = \"<table width='100%' border='0'>\";\n    $body .= \"<tr><td><img width='200' src='\" . getImageUrl() . \"' alt='Company Logo'></td>\";\n    $body .= \"<td style='position:absolute;left:350px;top:60px;'><h2><font color='#346699'>PMS Pvt Ltd.</font><h2></td></tr>\";\n    $body .= \"<tr><td colspan='2'><br/><br/><br/><strong>Dear \" . htmlspecialchars($name) . \",</strong></td></tr>\";\n    $body .= \"<tr><td colspan='2'><br/><font size='3'>As per Your request we send Your Password.</font><br/><br/>Password is : <b>\" . htmlspecialchars($pass) . \"</b></td></tr>\";\n    $body .= \"<tr><td colspan='2'><br/>If you have any questions, please feel free to contact us at:<br/><a href='mailto:support@pms.com' target='_blank'>support@pms.com</a></td></tr>\";\n    $body .= \"<tr><td colspan='2'><br/><br/>Best regards,<br>The PMS Team.</td></tr></table>\";\n\n    $subject = \"Forgot Password\";\n    sendMailWrapper($body, $to, $subject);\n}\n\nfunction sendMailWrapper($body, $to, $subject) {\n    $from = 'testing@gmail.com';\n    $headers = 'MIME-Version: 1.0' . \"\\r\\n\";\n    $headers .= 'Content-type: text/html; charset=iso-8859-1' . \"\\r\\n\";\n    $headers .= 'From: ' . $from . ' ' . \"\\r\\n\";\n    \n    if (mail($to, $subject, $body, $headers)) {\n        echo \"Password reset email sent to \" . htmlspecialchars($to) . \"\\n\";\n    } else {\n        echo \"Failed to send password reset email to \" . htmlspecialchars($to) . \"\\n\";\n    }\n}\n\nfunction getImageUrl() {\n    // This function constructs an absolute URL for an image.\n    // In a real application, you might store this URL in a config or database.\n    $protocol = isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? \"https://\" : \"http://\";\n    return $protocol . $_SERVER['SERVER_NAME'] . dirname($_SERVER['SCRIPT_NAME']) . \"/images/capacity.jpg\";\n}\n\n// Example usage:\n// sendForgotPasswordEmail('yourNewPass123', 'John Doe', 'john.doe@example.com');\n?>\n```\n\n## Method 1: Using PHP's Native `mail()` Function\n\nThe `mail()` function is PHP's built-in way to send emails. While simple, it requires careful header construction for HTML content and doesn't directly support attachments or embedded images without complex MIME handling.\n\n### Key Steps:\n\n1.  **Set `Content-Type` Header**: This is crucial. You must specify `Content-Type: text/html; charset=UTF-8` in your email headers.\n2.  **Use Absolute URLs for Images**: Email clients typically don't have access to your local file system. Images must be hosted on a publicly accessible web server, and their `src` attributes in the HTML should use full `http://` or `https://` URLs.\n3.  **Inline CSS (Recommended)**: While you can link external CSS, many email clients strip or ignore it. For consistent rendering, it's best to use inline CSS styles directly within your HTML tags.\n\n### Example: Basic HTML Email\n\n```php\n<?php\n$to = 'recipient@example.com';\n$subject = 'My First HTML Email';\n$message = '\n<html>\n<head>\n  <title>HTML Email</title>\n  <style>\n    body { font-family: Arial, sans-serif; line-height: 1.6; }\n    .container { width: 80%; margin: 0 auto; padding: 20px; border: 1px solid #ddd; }\n    h1 { color: #333; }\n    p { color: #555; }\n    img { max-width: 100%; height: auto; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h1>Welcome!</h1>\n    <p>This is a <strong>rich HTML email</strong> sent from PHP.</p>\n    <p>You can include paragraphs, lists, and even images:</p>\n    <img src=\"https://via.placeholder.com/300x150.png?text=Your+Logo\" alt=\"Placeholder Logo\">\n    <p>Visit our website: <a href=\"http://www.example.com\">Example.com</a></p>\n  </div>\n</body>\n</html>';\n\n// Always set content-type when sending HTML email\n$headers = \"MIME-Version: 1.0\\r\\n\";\n$headers .= \"Content-type:text/html;charset=UTF-8\\r\\n\";\n\n// More headers\n$headers .= 'From: Webmaster <webmaster@example.com>' . \"\\r\\n\";\n$headers .= 'Cc: myboss@example.com' . \"\\r\\n\";\n\nif (mail($to, $subject, $message, $headers)) {\n    echo \"HTML email sent successfully!\";\n} else {\n    echo \"Email sending failed.\";\n}\n?>\n```\n\n## Method 2: Using PHPMailer for Advanced Features\n\nFor more robust email sending, including file attachments, embedded images (CID), SMTP authentication, and better error handling, using a dedicated library like PHPMailer is highly recommended.\n\n### Why PHPMailer?\n\n*   **Attachments**: Easily attach files from your server.\n*   **Embedded Images**: Embed images directly into the email body using Content-ID (CID), so they appear even if the recipient is offline or the external server is down.\n*   **SMTP Support**: Send emails via an external SMTP server (e.g., Gmail, SendGrid, Mailgun) for higher deliverability and authentication.\n*   **HTML & Plain Text**: Automatically generates a plain-text alternative for HTML emails.\n*   **Error Handling**: Provides more detailed error messages than `mail()`.\n\n### Installation\n\nYou can install PHPMailer via Composer:\n\n```bash\ncomposer require phpmailer/phpmailer\n```\n\n### Example: HTML Email with Embedded Image and Attachment\n\n```php\n<?php\nuse PHPMailer\\PHPMailer\\PHPMailer;\nuse PHPMailer\\PHPMailer\\Exception;\n\nrequire 'vendor/autoload.php'; // Adjust path if not using Composer\n\n$mail = new PHPMailer(true); // Pass `true` to enable exceptions\n\ntry {\n    // Server settings\n    $mail->isSMTP();                                            // Send using SMTP\n    $mail->Host       = 'smtp.example.com';                     // Set the SMTP server to send through\n    $mail->SMTPAuth   = true;                                   // Enable SMTP authentication\n    $mail->Username   = 'your_email@example.com';               // SMTP username\n    $mail->Password   = 'your_smtp_password';                   // SMTP password\n    $mail->SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS;         // Enable TLS encryption; `PHPMailer::ENCRYPTION_SMTPS` also accepted\n    $mail->Port       = 587;                                    // TCP port to connect to\n\n    // Recipients\n    $mail->setFrom('from@example.com', 'Your Name');\n    $mail->addAddress('recipient@example.com', 'Recipient Name'); // Add a recipient\n    $mail->addReplyTo('info@example.com', 'Information');\n    $mail->addCC('cc@example.com');\n    $mail->addBCC('bcc@example.com');\n\n    // Attachments\n    // Create a dummy file for attachment if it doesn't exist\n    if (!file_exists('attachment.pdf')) {\n        file_put_contents('attachment.pdf', 'This is a dummy PDF attachment.');\n    }\n    $mail->addAttachment('attachment.pdf');         // Add attachments\n    \n    // Create a dummy image for embedding if it doesn't exist\n    if (!file_exists('logo.png')) {\n        // You'd typically have a real image here. For demonstration, let's create a tiny one.\n        $img = imagecreatetruecolor(100, 50);\n        $white = imagecolorallocate($img, 255, 255, 255);\n        $blue = imagecolorallocate($img, 0, 0, 255);\n        imagefill($img, 0, 0, $white);\n        imagestring($img, 5, 10, 15, 'Logo', $blue);\n        imagepng($img, 'logo.png');\n        imagedestroy($img);\n    }\n    $mail->AddEmbeddedImage('logo.png', 'logo_cid', 'logo.png'); // Embed an image\n\n    // Content\n    $mail->isHTML(true);                                  // Set email format to HTML\n    $mail->Subject = 'PHPMailer HTML Email with Embedded Image and Attachment';\n    $mail->Body    = '\n    <html>\n    <head>\n      <title>PHPMailer Test</title>\n    </head>\n    <body>\n      <h1>Hello from PHPMailer!</h1>\n      <p>This email contains an <strong>embedded image</strong> and an <strong>attachment</strong>.</p>\n      <img src=\"cid:logo_cid\" alt=\"Embedded Logo\" style=\"width:100px;\">\n      <p>Find your attached document below.</p>\n      <p>Best regards,</p>\n      <p>Your PHPMailer App</p>\n    </body>\n    </html>';\n    $mail->AltBody = 'This is the plain text message body for non-HTML mail clients. It also contains an attachment.';\n\n    $mail->send();\n    echo 'Message has been sent';\n} catch (Exception $e) {\n    echo \"Message could not be sent. Mailer Error: {$mail->ErrorInfo}\";\n}\n?>\n```\n\n## Common Problems & Solutions\n\n### 1. Images Not Displaying\n\n*   **Problem**: Images appear as broken links or don't load.\n*   **Solution (Native `mail()`):**\n    *   Ensure image `src` attributes use **absolute URLs** (e.g., `http://yourdomain.com/images/logo.png`). Relative paths will not work.\n    *   Verify the image file exists at the specified URL and is publicly accessible.\n    *   Check for typos in the URL.\n*   **Solution (PHPMailer):**\n    *   If using `AddEmbeddedImage()`, ensure the `cid` in the `src=\"cid:...\"` matches the one provided to `AddEmbeddedImage()`.\n    *   Verify the path to the image file on your server is correct.\n\n### 2. HTML Not Rendering Correctly\n\n*   **Problem**: Email client displays raw HTML tags or renders the layout incorrectly.\n*   **Solution**:\n    *   **`Content-Type` Header**: Double-check that your headers include `Content-Type: text/html; charset=UTF-8` (or `iso-8859-1`). This is the most common cause.\n    *   **Inline CSS**: Many email clients have limited CSS support and often strip external stylesheets. Use inline styles (`<p style=\"color: blue;\">`) for critical styling.\n    *   **HTML Structure**: Keep your HTML simple and use tables for layout, as they are more consistently supported across email clients than modern CSS layouts (like Flexbox or Grid). Avoid `<html>`, `<head>`, `<body>` tags within the `$message` variable if using `mail()`, as some webmail clients might wrap your content in their own, leading to nested/invalid HTML. PHPMailer handles this better.\n    *   **Email Client Differences**: Test your HTML email across various email clients (Gmail, Outlook, Apple Mail, etc.) as they all render HTML differently. Tools like Litmus or Email on Acid can help.\n\n### 3. Emails Going to Spam\n\n*   **Problem**: Your HTML emails are frequently marked as spam.\n*   **Solution**:\n    *   **Sender Authentication**: Use an authenticated SMTP server (e.g., via PHPMailer) rather than the default `mail()` function, which often sends from `localhost` or an unverified domain.\n    *   **SPF, DKIM, DMARC**: Configure these DNS records for your sending domain. They help email providers verify that your emails are legitimate.\n    *   **Content Quality**: Avoid spammy keywords, excessive images, or links to suspicious domains.\n    *   **Plain Text Alternative**: PHPMailer automatically generates a plain-text version (`AltBody`), which is good for deliverability. If using `mail()`, you'd need to manually create a multipart email.\n\n### 4. Character Encoding Issues\n\n*   **Problem**: Special characters (e.g., accents, emojis) appear as garbled text.\n*   **Solution**:\n    *   Ensure your `Content-Type` header specifies `charset=UTF-8`.\n    *   Make sure your PHP script file itself is saved with UTF-8 encoding.\n    *   If using PHPMailer, it defaults to UTF-8, but ensure your database connection (if pulling content from there) also uses UTF-8.\n\n## Real-World Use Cases\n\n*   **E-commerce Order Confirmations**: Send visually appealing order summaries with product images, pricing, and shipping details.\n*   **Newsletter Campaigns**: Distribute rich, branded newsletters with articles, promotions, and calls to action.\n*   **Password Reset Emails**: Provide a clear, branded email with a link to reset a password.\n*   **User Notifications**: Send welcome emails, account activity alerts, or subscription updates with custom branding.\n*   **Event Invitations**: Create engaging invitations with event details, maps, and RSVP buttons.\n\n## Related: Other PHP Email Operations\n\n*   **Sending Plain Text Emails**: Simply omit the `Content-Type: text/html` header.\n*   **Sending Emails with Attachments (without PHPMailer)**: This is significantly more complex with `mail()`, requiring manual construction of multipart MIME messages. It's generally not recommended for production.\n*   **Using Templating Engines**: For complex HTML emails, consider using a templating engine like Twig or Blade to separate your HTML structure from your PHP logic.\n*   **Transactional Email Services**: For high-volume or critical emails, integrate with services like SendGrid, Mailgun, or Amazon SES, which offer APIs and handle deliverability, tracking, and scaling.\n\n## Summary\n\nSending HTML emails in PHP is essential for modern web applications. While the native `mail()` function can handle basic HTML emails by setting the `Content-Type` header and linking external images, it quickly becomes cumbersome for more advanced needs like attachments, embedded images, or reliable SMTP delivery. For these scenarios, libraries like PHPMailer provide a robust, feature-rich, and easier-to-manage solution, significantly improving deliverability and developer experience. Always test your HTML emails across various clients to ensure consistent rendering.\n\n---\n\n## Image Generation Prompts\n\n**PLACEHOLDER-1:** A decision tree flowchart. The start node is \"Need to send HTML email?\". If \"No\", it goes to \"Send plain text email\". If \"Yes\", it branches to \"Need to embed images or attach files directly?\". If \"No, link images externally\", it goes to \"Use PHP's native mail() function\", then \"Set Content-Type: text/html header\", then \"Use absolute URLs for images\", and finally \"End\". If \"Yes, embed/attach\", it branches to \"Consider external library\". If \"Yes, for robustness/features\", it goes to \"Use PHPMailer or Symfony Mailer\", then \"Configure SMTP, add attachments/embedded images\", and finally \"End\". If \"No, simple embedding\", it goes to \"Advanced mail() with CID for embedded images\", then \"Requires complex MIME headers\", and finally \"End\". Use a clean, modern flowchart style with distinct colors for nodes and arrows.",
  "originalFormat": {
    "image_prompts": {
      "prompts": {
        "PLACEHOLDER-1": "A decision tree flowchart. The start node is \"Need to send HTML email?\". If \"No\", it goes to \"Send plain text email\". If \"Yes\", it branches to \"Need to embed images or attach files directly?\". If \"No, link images externally\", it goes to \"Use PHP's native mail() function\", then \"Set Content-Type: text/html header\", then \"Use absolute URLs for images\", and finally \"End\". If \"Yes, embed/attach\", it branches to \"Consider external library\". If \"Yes, for robustness/features\", it goes to \"Use PHPMailer or Symfony Mailer\", then \"Configure SMTP, add attachments/embedded images\", and finally \"End\". If \"No, simple embedding\", it goes to \"Advanced mail() with CID for embedded images\", then \"Requires complex MIME headers\", and finally \"End\". Use a clean, modern flowchart style with distinct colors for nodes and arrows."
      },
      "titles": {
        "PLACEHOLDER-1": "Email Sending Decision Tree"
      },
      "count": 1,
      "placeholder_list": [
        [
          "Email Sending Decision Tree",
          "1"
        ]
      ]
    },
    "generated_images": [
      {
        "placeholder": "PLACEHOLDER-1",
        "filename": "df157f8c-1.webp",
        "title": "Email Sending Decision Tree",
        "path": "staging/images/df157f8c-1.png"
      }
    ],
    "source_file": "/Users/thaddeus/Documents/on-going projects/deepv-stackoverflow-workflow-complete/data/crawled_data/11238953.json",
    "workflow_version": "deepv_stackoverflow_v2.0_schema_compliant",
    "generated_at": "2025-09-22T22:42:47.619209",
    "word_count": 2179,
    "code_blocks": 14
  }
}