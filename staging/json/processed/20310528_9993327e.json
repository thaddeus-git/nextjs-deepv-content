{
  "metadata": {
    "title": "How to Migrate an AWS EC2 Instance to Another Account",
    "slug": "how-to-migrate-aws-ec2-instance-to-another-account",
    "uniqueId": "9993327e",
    "category": "system-devops",
    "subcategory": "cloud",
    "description": "Learn the steps to move an AWS EC2 instance to a different AWS account, including considerations for IP addresses and data transfer.",
    "tags": [
      "aws",
      "ec2",
      "aws-migration",
      "ami",
      "cloud-migration",
      "elastic-ip",
      "aws-cli"
    ],
    "difficulty": "intermediate",
    "readTime": 8,
    "lastUpdated": "2024-09-21T12:30:00.000Z",
    "sourceStackOverflowId": "20310528",
    "votes": 18
  },
  "content": "# How to Migrate an AWS EC2 Instance to Another Account\n\nMigrating an AWS EC2 instance to a different AWS account is a common requirement for organizational changes, billing separation, or consolidation. While a direct \"move\" of a running instance is not possible, AWS provides a robust mechanism to achieve this by creating and sharing an Amazon Machine Image (AMI). This process allows you to replicate your instance's configuration and data in a new account.\n\n## Quick Answer\n\nYou cannot directly \"move\" a running EC2 instance between AWS accounts. The standard method involves creating an Amazon Machine Image (AMI) of the source instance, sharing that AMI with the target account, and then launching a new instance from the shared AMI in the target account. Be aware that Elastic IP addresses cannot be transferred between accounts, and the new instance will have a different private IP.\n\n## Choose Your Method\n\nThe best approach depends on your specific needs, especially regarding IP addresses and automation.\n\n```mermaid\ngraph TD\n    A[Start: Need to move EC2 instance to another AWS account?] --> B{Preserve Public IP?};\n    B -- Yes --> C[Elastic IP cannot be directly transferred. Consider DNS or AWS Support for EIP transfer (rare)];\n    B -- No --> D{Automate Migration?};\n    C --> D;\n    D -- Yes (Advanced) --> E[Use Infrastructure as Code (IaC) like Terraform/CloudFormation or specialized tools];\n    D -- No (Manual) --> F[Create AMI from source instance];\n    E --> G[Share AMI with target account];\n    F --> G;\n    G --> H[Launch new instance from shared AMI in target account];\n    H --> I[Configure new instance (e.g., attach new EIP, update DNS)];\n    I --> J[Verify and terminate old instance];\n    J --> K[End];\n```\n\n## Table of Contents\n1.  Quick Answer\n2.  Choose Your Method\n3.  Understanding AWS Account Migration Limitations\n4.  Step-by-Step Migration Using AMI\n5.  Handling Elastic IP Addresses\n6.  Automating EC2 Migration\n7.  Rethinking IP-Based Communication with DNS\n8.  Common Problems and Solutions\n9.  Summary\n\n## Understanding AWS Account Migration Limitations\n\nAWS does not offer a direct \"move\" or \"transfer\" feature for EC2 instances between accounts. This is primarily due to the isolated nature of AWS accounts, which are designed to be independent billing and resource containers. AWS Support also generally cannot directly manipulate resources across accounts.\n\nThe core principle for migration is **replication**: you create a copy of your instance's configuration and data, transfer that copy to the new account, and then launch a new instance from that copy.\n\n## Step-by-Step Migration Using AMI\n\nThe most common and recommended method for migrating an EC2 instance involves creating an Amazon Machine Image (AMI) and sharing it.\n\n### 1. Create a Custom AMI from the Source Instance\n\nAn AMI acts as a template for your instance, including the operating system, application server, and applications.\n\n1.  **Stop the instance (recommended):** While you can create an AMI from a running instance, stopping it ensures data consistency and integrity, especially for applications writing to disk.\n2.  **Create AMI:**\n    *   Navigate to the EC2 console.\n    *   Select the instance you want to migrate.\n    *   Go to `Actions` > `Image and templates` > `Create image`.\n    *   Provide an `Image name` and `Image description`.\n    *   Ensure \"No reboot\" is unchecked if the instance is running (or stop it beforehand).\n    *   Make sure all necessary EBS data volumes are included.\n    *   Click `Create image`.\n    *   Monitor the AMI creation process under `AMIs` in the EC2 console. This can take some time depending on the size of your volumes.\n\n    ![Create AMI from EC2 Instance](/images/9993327e-1.webp)\n\n### 2. Share the AMI with the Target Account\n\nOnce the AMI is available, you need to grant launch permissions to the target AWS account.\n\n1.  **Locate the AMI:** In the source account's EC2 console, go to `AMIs`.\n2.  **Modify AMI Permissions:**\n    *   Select the newly created AMI.\n    *   Go to `Actions` > `Modify image permissions`.\n    *   Under `AWS Account ID`, select `Private`.\n    *   Enter the 12-digit AWS account ID of the target account.\n    *   Click `Add permission`.\n    *   Click `Save changes`.\n\n    ![Share AMI with Target Account](/images/9993327e-2.webp)\n\n### 3. Launch a New Instance from the Shared AMI in the Target Account\n\nNow, log into the target AWS account and launch a new instance using the shared AMI.\n\n1.  **Log in to the Target Account:** Access the AWS Management Console with the target account credentials.\n2.  **Find the Shared AMI:**\n    *   Navigate to the EC2 console.\n    *   Go to `AMIs`.\n    *   In the filter dropdown, select `Private images` or `Owned by me` and then filter by the AMI ID or name. The shared AMI should appear.\n3.  **Launch Instance:**\n    *   Select the shared AMI.\n    *   Click `Launch instance from AMI`.\n    *   Follow the standard instance launch wizard:\n        *   Choose an instance type.\n        *   Configure instance details (VPC, subnet, IAM role, etc.).\n        *   Add storage (ensure all necessary volumes are attached).\n        *   Configure security groups (create new ones or use existing ones in the target account).\n        *   Review and launch.\n    *   **Important Note on Private IPs:** The private IP address of the new instance will be different unless you explicitly specify it during launch within a custom VPC configuration.\n\n    ![Launch Instance from Shared AMI](PLACEHOLDER-3)\n\n### 4. Configure and Verify the New Instance\n\nAfter launching, you'll need to perform post-launch configurations.\n\n1.  **Attach a new Elastic IP (if needed):** Elastic IPs cannot be transferred. Allocate a new EIP in the target account and associate it with the new instance.\n2.  **Update DNS records:** If you were using a DNS name, update it to point to the new Elastic IP or public IP of the new instance.\n3.  **Test applications:** Thoroughly test all applications and services running on the new instance to ensure everything is functioning correctly.\n4.  **Terminate the old instance:** Once you've confirmed the new instance is fully operational and serving traffic, you can terminate the original instance in the source account to avoid incurring unnecessary costs.\n\n## Handling Elastic IP Addresses\n\nA critical consideration during migration is the Elastic IP (EIP). **Elastic IPs cannot be directly transferred between AWS accounts.**\n\n*   **Scenario 1: You are using an Elastic IP.**\n    *   You will need to release the EIP from the source instance (after updating DNS or ensuring traffic is cut over).\n    *   Allocate a *new* EIP in the target account.\n    *   Associate the new EIP with your newly launched instance.\n    *   **Impact:** This means your public IP address will change. If external systems (like banks in the original question) are hardcoded to this IP, they will need to update their configurations.\n*   **Scenario 2: You are not using an Elastic IP.**\n    *   The public IP of your instance will change upon restart or termination/relaunch anyway.\n    *   The new instance in the target account will receive a new public IP.\n    *   **Recommendation:** Always use Elastic IPs for stable public endpoints, or even better, use DNS.\n\n### Mitigating IP Change Impact\n\nIf changing the public IP is not an option, consider these:\n\n*   **DNS (Highly Recommended):** The best practice is to always use a DNS name (e.g., `mywebsite.com`) instead of a direct IP address. If banks are communicating via DNS, you simply update the DNS record to point to the new instance's EIP, and the change is transparent to them.\n*   **AWS Support (Limited):** In extremely rare and critical enterprise scenarios, AWS Support *might* be able to assist with EIP transfer, but this is not a standard offering and usually requires a strong business case and enterprise support plan. Do not rely on this as a primary solution.\n\n## Automating EC2 Migration\n\nFor complex environments or frequent migrations, manual steps can be error-prone and time-consuming.\n\n### Infrastructure as Code (IaC)\n\nTools like AWS CloudFormation, Terraform, Pulumi, or AWS CDK can automate the creation of resources in the target account.\n\n1.  **Export Configuration:** Use tools like `CloudFormer` (for CloudFormation) or `Terraforming` (for Terraform) to generate IaC templates from your existing resources in the source account.\n2.  **Modify Templates:** Adjust the templates to reflect the target account's environment (e.g., VPC IDs, subnet IDs, security group IDs).\n3.  **AMI Integration:** The IaC template would reference the shared AMI ID.\n4.  **Deploy:** Deploy the IaC template in the target account to provision the new instance and its associated resources (security groups, IAM roles, etc.).\n\n### Specialized Migration Tools\n\nSome third-party tools or AWS Partner solutions offer more streamlined migration experiences, especially for \"lift and shift\" scenarios. Examples include KopiCloud (mentioned in one answer) or other cloud migration services. These tools often handle the AMI creation, sharing, and instance launch steps, sometimes with additional features like data synchronization.\n\n## Rethinking IP-Based Communication with DNS\n\nThe original problem highlights a critical design flaw: relying on a static IP address for external communication.\n\n### Benefits of DNS\n\n*   **Flexibility:** Easily change underlying server IPs without impacting clients.\n*   **High Availability:** Use DNS to point to different instances for failover or load balancing.\n*   **Scalability:** Distribute traffic across multiple instances.\n\n### Migration Strategy with DNS\n\n1.  **Setup DNS Record:** Create a DNS record (e.g., an A record) for your server's public IP in the source account.\n2.  **Transition Clients to DNS:** Work with the banks to update their configurations to use the DNS name instead of the direct IP. This is a crucial step that needs to happen *before* the actual instance migration.\n3.  **Perform AMI Migration:** Follow the steps above to create and launch the new instance in the target account.\n4.  **Update DNS:** Once the new instance is running and has a new Elastic IP, update the DNS record to point to this new EIP. The change will propagate, and clients using the DNS name will seamlessly connect to the new instance.\n\n    ![DNS Migration Flow](/images/9993327e-4.webp)\n\n## Common Problems and Solutions\n\n*   **Problem:** \"My instance's private IP changed.\"\n    *   **Solution:** This is expected. If your applications rely on specific private IPs, you'll need to update configurations or design your applications to use DNS or service discovery within the VPC.\n*   **Problem:** \"I can't transfer my Elastic IP.\"\n    *   **Solution:** This is an AWS limitation. You must allocate a new EIP in the target account. The best long-term solution is to use DNS for external communication.\n*   **Problem:** \"AMI creation failed or is taking too long.\"\n    *   **Solution:** Ensure the instance has enough free disk space. If it's a large instance, AMI creation can take time. Check the status in the EC2 console. Stopping the instance before AMI creation can help.\n*   **Problem:** \"Shared AMI not visible in target account.\"\n    *   **Solution:** Double-check the 12-digit AWS account ID entered during the sharing process. Ensure you are looking under \"Private images\" or \"Owned by me\" in the target account's AMI list.\n*   **Problem:** \"New instance not working after launch.\"\n    *   **Solution:** Verify security group rules, network ACLs, and IAM roles in the target account. Ensure the instance type is compatible with the AMI. Check system logs for errors.\n\n## Summary\n\nMigrating an AWS EC2 instance to another account is a multi-step process that primarily involves creating an AMI, sharing it, and launching a new instance. While direct instance transfer is not possible, this AMI-based approach is robust and widely used. The most significant challenge is often the inability to transfer Elastic IP addresses, which necessitates careful planning, especially if external systems rely on a fixed IP. Adopting DNS for all external communication is the recommended best practice to avoid such issues in the future.\n\n---\n\n## Image Generation Prompts\n\n**PLACEHOLDER-1:** A screenshot of the AWS EC2 console showing an instance selected, with the \"Actions\" dropdown open, highlighting \"Image and templates\" and \"Create image\" options. The screenshot should clearly show the instance ID and status.\n\n**PLACEHOLDER-2:** A screenshot of the AWS EC2 console's \"Modify Image Permissions\" dialog box. It should show the \"Private\" option selected, an input field for \"AWS Account ID\" with a sample 12-digit ID entered, and the \"Add permission\" and \"Save changes\" buttons highlighted.\n\n**PLACEHADER-3:** A screenshot of the AWS EC2 console's \"Launch an instance from AMI\" wizard. It should show the \"Choose an Amazon Machine Image (AMI)\" step, with a custom AMI selected, and the \"Launch instance from AMI\" button highlighted.\n\n**PLACEHOLDER-4:** A clear, simple diagram illustrating the DNS migration flow. It should show:\n1.  An \"Old EC2 Instance (Account A)\" with an \"Old EIP\".\n2.  A \"DNS Record (e.g., myapp.com)\" initially pointing to the \"Old EIP\".\n3.  A \"New EC2 Instance (Account B)\" with a \"New EIP\".\n4.  An arrow showing the DNS record being updated to point to the \"New EIP\".\n5.  A \"Client\" communicating with \"myapp.com\", with arrows showing traffic first to the old, then to the new instance after DNS update.\nUse simple icons for EC2 instances, EIPs, DNS, and clients.",
  "originalFormat": {
    "image_prompts": {
      "prompts": {
        "PLACEHOLDER-1": "A screenshot of the AWS EC2 console showing an instance selected, with the \"Actions\" dropdown open, highlighting \"Image and templates\" and \"Create image\" options. The screenshot should clearly show the instance ID and status.",
        "PLACEHOLDER-2": "A screenshot of the AWS EC2 console's \"Modify Image Permissions\" dialog box. It should show the \"Private\" option selected, an input field for \"AWS Account ID\" with a sample 12-digit ID entered, and the \"Add permission\" and \"Save changes\" buttons highlighted.\n\n**PLACEHADER-3:** A screenshot of the AWS EC2 console's \"Launch an instance from AMI\" wizard. It should show the \"Choose an Amazon Machine Image (AMI)\" step, with a custom AMI selected, and the \"Launch instance from AMI\" button highlighted.",
        "PLACEHOLDER-4": "A clear, simple diagram illustrating the DNS migration flow. It should show:\n1.  An \"Old EC2 Instance (Account A)\" with an \"Old EIP\".\n2.  A \"DNS Record (e.g., myapp.com)\" initially pointing to the \"Old EIP\".\n3.  A \"New EC2 Instance (Account B)\" with a \"New EIP\".\n4.  An arrow showing the DNS record being updated to point to the \"New EIP\".\n5.  A \"Client\" communicating with \"myapp.com\", with arrows showing traffic first to the old, then to the new instance after DNS update.\nUse simple icons for EC2 instances, EIPs, DNS, and clients."
      },
      "titles": {
        "PLACEHOLDER-1": "Create AMI from EC2 Instance",
        "PLACEHOLDER-2": "Share AMI with Target Account",
        "PLACEHOLDER-3": "Launch Instance from Shared AMI",
        "PLACEHOLDER-4": "DNS Migration Flow"
      },
      "count": 3,
      "placeholder_list": [
        [
          "Create AMI from EC2 Instance",
          "1"
        ],
        [
          "Share AMI with Target Account",
          "2"
        ],
        [
          "Launch Instance from Shared AMI",
          "3"
        ],
        [
          "DNS Migration Flow",
          "4"
        ]
      ]
    },
    "generated_images": [
      {
        "placeholder": "PLACEHOLDER-1",
        "filename": "9993327e-1.webp",
        "title": "Create AMI from EC2 Instance",
        "path": "staging/images/9993327e-1.png"
      },
      {
        "placeholder": "PLACEHOLDER-2",
        "filename": "9993327e-2.webp",
        "title": "Share AMI with Target Account",
        "path": "staging/images/9993327e-2.png"
      },
      {
        "placeholder": "PLACEHOLDER-4",
        "filename": "9993327e-4.webp",
        "title": "DNS Migration Flow",
        "path": "staging/images/9993327e-4.png"
      }
    ],
    "source_file": "/Users/thaddeus/Documents/on-going projects/deepv-stackoverflow-workflow-complete/data/crawled_data/20310528.json",
    "workflow_version": "deepv_stackoverflow_v2.0_schema_compliant",
    "generated_at": "2025-09-22T22:47:08.553902",
    "word_count": 2105,
    "code_blocks": 2
  }
}