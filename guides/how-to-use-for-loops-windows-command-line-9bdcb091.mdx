---
title: "How to Use For Loops in Windows Command Line (CMD)"
slug: "how-to-use-for-loops-windows-command-line"
category: "system-devops"
subcategory: "shell"
description: "Learn to automate repetitive tasks in Windows Command Prompt using FOR loops, iterating through files or numerical ranges."
tags: ["windows","cmd","batch-script","for-loop","automation","loops"]
difficulty: "beginner"
readTime: 5
lastUpdated: "2025-09-22T16:16:54.198Z"
featured: false
---

# How to Use For Loops in Windows Command Line (CMD)

## Quick Answer

To iterate through files in the current directory using a `FOR` loop in Windows Command Prompt, use the following syntax:

```bash
FOR %i IN (*.ext) DO my-function %i
```

Replace `*.ext` with your desired file pattern (e.g., `*.txt`, `image_*.jpg`) and `my-function` with the command or script you want to execute for each file. If used within a batch file (`.bat`), use `%%i` instead of `%i`.

## Choose Your Method

Deciding which `FOR` loop syntax to use in Windows Command Line depends on your specific needs: iterating over files, numbers, or command output, and whether you're running it directly in the console or within a batch script.

```mermaid
graph TD
    A[Start] --> B{Need to iterate over files/folders?};
    B -- Yes --> C{Running directly in CMD?};
    C -- Yes --> D[Use FOR %i IN (filespec) DO command %i];
    C -- No (Batch file) --> E[Use FOR %%i IN (filespec) DO command %%i];
    B -- No --> F{Need to iterate over a sequence of numbers?};
    F -- Yes --> G[Use FOR /L %i IN (start,step,end) DO command %i];
    F -- No --> H{Need to iterate over command output?};
    H -- Yes --> I[Use FOR /F %i IN ('command') DO command %i];
    I -- No --> J[Consider other scripting languages or advanced FOR options];
```

## Table of Contents
1. Quick Answer
2. Choose Your Method
3. Ready-to-Use Code
4. Method 1: Iterating Through Files (Basic `FOR` Loop)
5. Method 2: Iterating Through Files in a Batch Script
6. Method 3: Iterating Through a Numerical Range (`FOR /L`)
7. Method 4: Iterating Through Command Output (`FOR /F`)
8. Common Problems & Solutions
9. Real-World Use Cases
10. Summary

## Ready-to-Use Code

Here are some common `FOR` loop patterns for quick use:

**1. Loop through all `.txt` files in the current directory (CMD prompt):**
```bash
FOR %f IN (*.txt) DO ECHO Processing file: %f
```

**2. Loop through all `.txt` files in a specific directory (Batch file):**
```batch
@echo off
FOR %%f IN ("C:\MyData\*.txt") DO ECHO Processing file: %%f
```

**3. Loop from 1 to 100 (CMD prompt):**
```bash
FOR /L %i IN (1,1,100) DO ECHO Current number: %i
```

**4. Loop through lines of a text file (Batch file):**
```batch
@echo off
FOR /F "delims=" %%L IN (myfile.txt) DO ECHO Line content: %%L
```

## Method 1: Iterating Through Files (Basic `FOR` Loop)

The most common use case for `FOR` loops in Windows Command Line is to process a set of files. This method is ideal when you need to run a command on each file matching a certain pattern.

### Syntax

The basic syntax for iterating through files directly in the command prompt is:

```bash
FOR %variable IN (set) DO command %variable
```

-   `%variable`: A single letter (e.g., `%i`, `%f`) that will hold the current item from the `set`.
-   `set`: The list of items to iterate over. This can be a wildcard file specification (e.g., `*.txt`, `image_*.jpg`), a list of specific files (e.g., `file1.txt file2.doc`), or even directory paths.
-   `command`: The command to execute for each item in the `set`.

### Example: Processing Files

Let's say you have several `.log` files in your current directory, and you want to display the content of each one.

```bash
FOR %i IN (*.log) DO TYPE %i
```

This command will:
1.  Find all files ending with `.log` in the current directory.
2.  For each file found, it will assign its name to the variable `%i`.
3.  It will then execute the `TYPE` command, passing the file name (`%i`) as an argument.

### Example: Using a Function/External Program

If you have an external program or a batch script (`my-function.bat`) that processes a single file, you can integrate it:

```bash
FOR %i IN (*.ext) DO my-function.bat %i
```

This will execute `my-function.bat` for every file matching `*.ext`, passing the filename as an argument to `my-function.bat`.

## Method 2: Iterating Through Files in a Batch Script

When you move `FOR` loops into a batch file (`.bat` or `.cmd`), there's a crucial syntax change: you must double the percent signs for the loop variable.

### Syntax for Batch Files

```batch
FOR %%variable IN (set) DO command %%variable
```

-   `%%variable`: Notice the double percent signs. This is required when using `FOR` loops inside a batch script.

### Example: Renaming Files in a Batch Script

Suppose you want to rename all `.txt` files to `.bak` in a batch script.

```batch
@echo off
ECHO Renaming .txt files to .bak...
FOR %%f IN (*.txt) DO (
    ECHO Renaming "%%f" to "%%~nf.bak"
    REN "%%f" "%%~nf.bak"
)
ECHO Done.
```

In this example:
-   `%%f` is the loop variable.
-   `%%~nf` extracts just the name of the file (without extension) from `%%f`. This is one of many variable modifiers available with `FOR` loops.
-   The `()` block allows you to execute multiple commands for each iteration.

![Batch File For Loop](PLACEHOLDER: Batch File For Loop - /images/f0fa9627-1.webp)

## Method 3: Iterating Through a Numerical Range (`FOR /L`)

The `FOR /L` command allows you to generate and iterate through a sequence of numbers. This is useful for tasks that require a fixed number of iterations or processing items by index.

### Syntax

```bash
FOR /L %variable IN (start,step,end) DO command %variable
```

-   `start`: The starting number of the sequence.
-   `step`: The increment value for each iteration.
-   `end`: The ending number of the sequence. The loop continues as long as the current number is less than or equal to `end`.

### Example: Counting from 1 to 10

To simply count from 1 to 10:

```bash
FOR /L %i IN (1,1,10) DO ECHO %i
```

Output:
```output
1
2
3
4
5
6
7
8
9
10
```

### Example: Processing 17 Files by Index (as per original question)

If your files are named sequentially (e.g., `file1.dat`, `file2.dat`, ..., `file17.dat`), you could use `FOR /L` to process them:

```bash
FOR /L %i IN (1,1,17) DO my-software.exe "file%i.dat" "output%i.result"
```

This command would execute `my-software.exe` 17 times, passing `file1.dat` and `output1.result` in the first iteration, `file2.dat` and `output2.result` in the second, and so on.

## Method 4: Iterating Through Command Output (`FOR /F`)

The `FOR /F` command is powerful for parsing text files, strings, or the output of other commands. It allows you to process each line or token from the input.

### Syntax

```bash
FOR /F ["options"] %variable IN ('command' OR "string" OR file) DO command %variable
```

-   `"options"`: Optional parameters like `delims` (delimiters), `tokens` (which tokens to parse), `skip` (lines to skip), etc.
-   `'command'`: Executes a command and processes its output line by line.
-   `"string"`: Processes a literal string.
-   `file`: Processes the content of a file line by line.

### Example: Listing Running Processes

To list all running processes and display their names:

```bash
FOR /F "tokens=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127" %i IN ('tasklist /fo list') DO @IF DEFINED %i ECHO %i
```
This command uses `tasklist /fo list` to get process information and then iterates through each line, echoing it. The `tokens` option is used to ensure that the entire line is captured, as `FOR /F` by default splits lines into tokens based on spaces.

### Example: Reading a Text File Line by Line

To read a file named `config.txt` line by line:

```bash
FOR /F "delims=" %L IN (config.txt) DO ECHO %L
```

-   `delims=` tells `FOR /F` not to use any delimiters, so the entire line is treated as a single token.
-   `%L` will contain the full content of each line.

## Common Problems & Solutions

### 1. `%i` vs `%%i` Error

**Problem:** Using `%i` in a batch file or `%%i` directly in the command prompt.
**Solution:**
-   **In CMD prompt:** Use single percent sign: `FOR %i IN (...) DO ... %i`
-   **In Batch file (`.bat` or `.cmd`):** Use double percent signs: `FOR %%i IN (...) DO ... %%i`

### 2. Spaces in File Paths

**Problem:** `FOR` loops can struggle with file paths containing spaces if not properly quoted.
**Solution:** Always enclose file paths and variables that might contain spaces in double quotes.

```bash
REM Correct (CMD prompt)
FOR %f IN ("C:\My Files\*.txt") DO ECHO "%f"

REM Correct (Batch file)
FOR %%f IN ("C:\My Files\*.txt") DO ECHO "%%f"
```

### 3. Accessing File Properties (Name, Extension, Path)

**Problem:** You need just the filename without the path, or just the extension.
**Solution:** Use `FOR` variable modifiers.

-   `%~nf`: Expands `%f` to a file name only.
-   `%~xf`: Expands `%f` to a file extension only.
-   `%~pf`: Expands `%f` to a path only.
-   `%~dpf`: Expands `%f` to drive letter and path only.
-   `%~nxf`: Expands `%f` to file name and extension only.

Example (Batch file):
```batch
@echo off
FOR %%f IN ("C:\MyFolder\My Document.docx") DO (
    ECHO Full path: %%f
    ECHO Filename only: %%~nf
    ECHO Extension only: %%~xf
    ECHO Drive and path: %%~dpf
    ECHO Filename and extension: %%~nxf
)
```

Output:
```output
Full path: C:\MyFolder\My Document.docx
Filename only: My Document
Extension only: .docx
Drive and path: C:\MyFolder\
Filename and extension: My Document.docx
```

### 4. Infinite Loops with `GOTO`

**Problem:** Using `GOTO` for looping can lead to infinite loops if the exit condition is not met or is flawed.
**Solution:** While `GOTO` can create loops, `FOR` is generally safer and more structured for iteration. If using `GOTO`, ensure a clear and reachable exit condition.

Example of a `GOTO` loop (less recommended for file processing):
```batch
@echo off
SET /A counter=0
:loop_start
    SET /A counter+=1
    IF %counter% GTR 10 GOTO loop_end
    ECHO Current count: %counter%
GOTO loop_start
:loop_end
ECHO Loop finished.
```

## Real-World Use Cases

`FOR` loops are incredibly versatile for automating various tasks in Windows.

1.  **Bulk File Processing:**
    -   Converting image formats: `FOR %%f IN (*.jpg) DO convert.exe "%%f" "%%~nf.png"`
    -   Compressing files: `FOR %%f IN (*.log) DO 7z a "%%~nf.zip" "%%f"`
    -   Applying a custom script to multiple data files.

2.  **Log File Analysis:**
    -   Searching for specific errors across multiple log files: `FOR %%f IN (*.log) DO FINDSTR "ERROR" "%%f"`
    -   Archiving old logs: `FORFILES /P "C:\Logs" /M "*.log" /D -30 /C "cmd /c MOVE @file C:\OldLogs"` (Note: `FORFILES` is another powerful command for date-based iteration).

3.  **Directory Management:**
    -   Creating a series of numbered folders: `FOR /L %%i IN (1,1,10) DO MD "Project_%%i"`
    -   Deleting empty directories.

4.  **System Information Gathering:**
    -   Listing all services and their status: `FOR /F "tokens=1,2*" %%a IN ('sc query state= all ^| findstr "SERVICE_NAME STATE"') DO ECHO Service: %%b, State: %%c`

## Summary

Windows Command Line `FOR` loops are a powerful tool for automating repetitive tasks, especially when dealing with files, numerical sequences, or command output. Understanding the different `FOR` loop variants (`FOR`, `FOR /L`, `FOR /F`) and the crucial distinction between `%variable` (CMD) and `%%variable` (batch files) is key to effective scripting. By leveraging these constructs, you can significantly streamline your workflow and avoid manual, tedious operations.

---

## Image Generation Prompts

**PLACEHOLDER-1:** A diagram illustrating the flow of a batch script using a `FOR` loop. The diagram should show a `FOR` loop icon, an arrow pointing to a `( )` block representing multiple commands, and then an arrow pointing to a `REN` command. Text labels should indicate "Batch File Start", "FOR %%f IN (*.txt)", "Execute Commands for Each File", "REN '%%f' '%%~nf.bak'", and "Batch File End". Use a clean, modern flowchart style.